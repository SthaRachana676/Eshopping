!function(){function g(e,t,i,r){if(!e.isReadOnly()&&!e.equals(i.editable())){CKEDITOR.dom.element.setMarker(r,e,"bidi_processed",1),r=e;for(var n=i.editable();(r=r.getParent())&&!r.equals(n);)if(r.getCustomData("bidi_processed"))return e.removeStyle("direction"),void e.removeAttribute("dir");((r=i.config.useComputedState)?e.getComputedStyle("direction"):e.getStyle("direction")||e.hasAttribute("dir"))!=t&&(e.removeStyle("direction"),r?(e.removeAttribute("dir"),t!=e.getComputedStyle("direction")&&e.setAttribute("dir",t)):e.setAttribute("dir",t),i.forceNextSelectionCheck())}}function i(u){return{context:"p",allowedContent:{"h1 h2 h3 h4 h5 h6 table ul ol blockquote div tr p div li td":{propertiesOnly:!0,attributes:"dir"}},requiredContent:"p[dir]",refresh:function(e,t){var i=e.config.useComputedState;if(!i)for(var r=t.lastElement,n=e.editable();r&&!(r.getName()in a||r.equals(n));){var o=r.getParent();if(!o)break;r=o}(r=(r=r||t.block||t.blockLimit).equals(e.editable())&&(n=e.getSelection().getRanges()[0].getEnclosedNode())&&n.type==CKEDITOR.NODE_ELEMENT?n:r)&&(i=i?r.getComputedStyle("direction"):r.getStyle("direction")||r.getAttribute("dir"),e.getCommand("bidirtl").setState("rtl"==i?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF),e.getCommand("bidiltr").setState("ltr"==i?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)),(i=(t.block||t.blockLimit||e.editable()).getDirection(1))!=(e._.selDir||e.lang.dir)&&(e._.selDir=i,e.fire("contentDirChanged",i))},exec:function(e){var t=e.getSelection(),r=e.config.enterMode;if((a=t.getRanges())&&a.length){for(var i,n={},o=t.createBookmarks(),a=a.createIterator(),d=0;i=a.getNextRange(1);){var l=i.getEnclosedNode();(l=!l||l&&!(l.type==CKEDITOR.NODE_ELEMENT&&l.getName()in O)?function(e,t,i){var r,n=e.getCommonAncestor(!1,!0);if((e=e.clone()).enlarge(i==CKEDITOR.ENTER_BR?CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS:CKEDITOR.ENLARGE_BLOCK_CONTENTS),e.checkBoundaryOfElement(n,CKEDITOR.START)&&e.checkBoundaryOfElement(n,CKEDITOR.END)){for(;n&&n.type==CKEDITOR.NODE_ELEMENT&&(r=n.getParent())&&1==r.getChildCount()&&!(n.getName()in t);)n=r;return n.type==CKEDITOR.NODE_ELEMENT&&n.getName()in t&&n}}(i,T,r):l)&&g(l,u,e,n);var c=new CKEDITOR.dom.walker(i),E=o[d].startNode,s=o[d++].endNode;for(c.evaluator=function(e){var t,i=r==CKEDITOR.ENTER_P?"p":"div";return!!((t=(t=!!e&&e.type==CKEDITOR.NODE_ELEMENT&&e.getName()in T)?!((i=(i=e.is(i))?!!(i=e.getParent())&&i.type==CKEDITOR.NODE_ELEMENT:i)&&e.getParent().is("blockquote")):t)&&e.getPosition(E)&CKEDITOR.POSITION_FOLLOWING&&(e.getPosition(s)&CKEDITOR.POSITION_PRECEDING+CKEDITOR.POSITION_CONTAINS)==CKEDITOR.POSITION_PRECEDING)};l=c.next();)g(l,u,e,n);for((i=i.createIterator()).enlargeBr=r!=CKEDITOR.ENTER_BR;l=i.getNextParagraph(r==CKEDITOR.ENTER_P?"p":"div");)g(l,u,e,n)}CKEDITOR.dom.element.clearAllMarkers(n),e.forceNextSelectionCheck(),t.selectBookmarks(o),e.focus()}}}}function e(n){var o=n==t.setAttribute,a=n==t.removeAttribute,d=/\bdirection\s*:\s*(.*?)\s*(:?$|;)/;return function(e,t){if(!this.isReadOnly()){if(i=e==(o||a?"dir":"direction")||"style"==e&&(a||d.test(t))){e:{for(var i,r=(i=this).getDocument().getBody().getParent();i;){if(i.equals(r)){i=!1;break e}i=i.getParent()}i=!0}i=!i}if(i&&(i=this.getDirection(1),r=n.apply(this,arguments),i!=this.getDirection(1)))return this.getDocument().fire("dirChanged",this),r}return n.apply(this,arguments)}}var T={table:1,ul:1,ol:1,blockquote:1,div:1},O={},a={};CKEDITOR.tools.extend(O,T,{tr:1,p:1,div:1,li:1}),CKEDITOR.tools.extend(a,O,{td:1}),CKEDITOR.plugins.add("bidi",{lang:"af,ar,az,bg,bn,bs,ca,cs,cy,da,de,de-ch,el,en,en-au,en-ca,en-gb,eo,es,es-mx,et,eu,fa,fi,fo,fr,fr-ca,gl,gu,he,hi,hr,hu,id,is,it,ja,ka,km,ko,ku,lt,lv,mk,mn,ms,nb,nl,no,oc,pl,pt,pt-br,ro,ru,si,sk,sl,sq,sr,sr-latn,sv,th,tr,tt,ug,uk,vi,zh,zh-cn",icons:"bidiltr,bidirtl",hidpi:!0,init:function(o){function e(e,t,i,r,n){o.addCommand(i,new CKEDITOR.command(o,r)),o.ui.addButton&&o.ui.addButton(e,{label:t,command:i,toolbar:"bidi,"+n})}var t;o.blockless||(e("BidiLtr",(t=o.lang.bidi).ltr,"bidiltr",i("ltr"),10),e("BidiRtl",t.rtl,"bidirtl",i("rtl"),20),o.on("contentDom",function(){o.document.on("dirChanged",function(e){o.fire("dirChanged",{node:e.data,dir:e.data.getDirection(1)})})}),o.on("contentDirChanged",function(e){e=(o.lang.dir!=e.data?"add":"remove")+"Class";var t=o.ui.space(o.config.toolbarLocation);t&&t[e]("cke_mixed_dir_content")}))}});for(var t=CKEDITOR.dom.element.prototype,r=["setStyle","removeStyle","setAttribute","removeAttribute"],n=0;n<r.length;n++)t[r[n]]=CKEDITOR.tools.override(t[r[n]],e)}();